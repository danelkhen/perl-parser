<!DOCTYPE html>
<html>
<head>
    <title>CodeViewer</title>
    <base href="/" />
    <meta charset="utf-8" />
    <link rel="shortcut icon" type="image/png" href="/res/viewer/img/code.png" />
    <link href='//fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
    <link href="/res/viewer/css/index.css" rel="stylesheet" />
    <link href="/res/viewer/css/theme-light.css" rel="stylesheet" />

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="/res/libs/corex.js"></script>
    <script src="/res/libs/corex-jquery.js"></script>
    <link href="//cdnjs.cloudflare.com/ajax/libs/tether-tooltip/1.2.0/css/tooltip-theme-arrows.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/tether/1.3.2/js/tether.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/tether-drop/1.4.2/js/drop.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/tether-tooltip/1.2.0/js/tooltip.min.js"></script>

    <script src="/res/node_modules/requirejs/require.js"></script>
    <script src="/res/built/perl-parser/perl-parser.js"></script>

    <script>
        require.config({
            //baseUrl: "/another/path",
            //waitSeconds: 15
            paths: {
                "viewer":"/res/built/viewer",
                "ace":"/res/ace",
                "perl-parser": "/res/built/perl-parser/perl-parser",
                "perl-parser/extensions": "/res/built/perl-parser/perl-parser",
            },
        });
        require(["viewer/index"]);
    </script>
    <!--<style>
        .layout,.loading,.debug{display:none;}
        #editor{position:absolute;left:0;top:0;right:0;bottom:0;}
    </style>-->
</head>
<body>
    <div class="loading">Loading...</div>
    <div class="debug"></div>
    <div id="editor"></div>
    <table class="layout">
        <tr class="top">
            <td>
                <div class="top-bar">
                    <div class="menu">
                        <a class="btn btnUp is-folder" href="../" _if="isFolder()">up</a>
                        <a class="btn btnUp is-file" href="./" _if="isFile()">up</a>
                        <button class="btn" _onclick="e => this.critique()">critique</button>
                        <button class="btn" _onclick="e => this.editor.expandOrCollapseAll()">toggle</button>
                        <button class="btn" _onclick="e => this.gitBlame()">blame</button>
                    </div>
                </div>
            </td>
        </tr>
        <tr class="main">
            <td>
                <div class="dir-view" _if="isFolder()">
                    <table>
                        <tr class="{{t => 'child template'}}" _for="file.children"><td><a href="{{path}}">{{name}}</a></td><td>{{size}}</td></tr>
                    </table>
                </div>
                <div _if="isFile()" class="code-view">
                    <div class="code-container" _ignore>
                        <div class="lines"><div class="line"><div class="line-overlay"></div><a class="line-number">1</a><div class="expander-container"></div></div></div>
                        <div class="td-code"><div class="code"></div><textarea class="caret" spellcheck="false"></textarea></div>
                    </div>
                </div>
            </td>
        </tr>
        <tr class="bottom">
            <td>
                <div class="bottom-bar" _if="critiqueRes!=null" style="display:none">
                    <div class="pane">
                        <div class="critique" _if="critiqueRes!=null">
                            <table class="grid">
                                <thead>
                                    <tr>
                                        <th>description</th>
                                        <th>policy</th>
                                        <th>line</th>
                                        <th>severity</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="critique-row template" _for="critiqueRes.violations" _onclick="(e, violation) => this.violation_click(e, violation)">
                                        <td>{{description}}</td>
                                        <td>{{policy}}</td>
                                        <td>{{source.location.line}}</td>
                                        <td>{{severity}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </td>
        </tr>
    </table>
</body>
</html>
